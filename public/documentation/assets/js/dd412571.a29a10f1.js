"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[445],{8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var s=r(6540);const i={},t=s.createContext(i);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:n},e.children)}},9298:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"cron/configuration","title":"Configuration avanc\xe9e","description":"Guide complet pour personnaliser le syst\xe8me de mise \xe0 jour automatique.","source":"@site/docs/cron/configuration.md","sourceDirName":"cron","slug":"/cron/configuration","permalink":"/documentation/cron/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/RiusmaX/tamagotcho/tree/master/documentation/docs/cron/configuration.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Configuration avanc\xe9e"},"sidebar":"tutorialSidebar","previous":{"title":"Guide de d\xe9marrage rapide","permalink":"/documentation/cron/quickstart"},"next":{"title":"R\xe9f\xe9rence API","permalink":"/documentation/cron/api-reference"}}');var i=r(4848),t=r(8453);const o={sidebar_position:3,title:"Configuration avanc\xe9e"},a="\u2699\ufe0f Configuration avanc\xe9e",l={},d=[{value:"\ud83d\udccb Options du composant",id:"-options-du-composant",level:2},{value:"Interface <code>MonstersAutoUpdaterProps</code>",id:"interface-monstersautoupdaterprops",level:3},{value:"\ud83c\udf9b\ufe0f Configurations courantes",id:"\ufe0f-configurations-courantes",level:2},{value:"Configuration par d\xe9faut (1-3 minutes)",id:"configuration-par-d\xe9faut-1-3-minutes",level:3},{value:"Configuration rapide (30s - 1min)",id:"configuration-rapide-30s---1min",level:3},{value:"Configuration lente (5-10 minutes)",id:"configuration-lente-5-10-minutes",level:3},{value:"Intervalle fixe (toujours 2 minutes)",id:"intervalle-fixe-toujours-2-minutes",level:3},{value:"Mode d\xe9veloppement (debug complet)",id:"mode-d\xe9veloppement-debug-complet",level:3},{value:"D\xe9sactiv\xe9 (arr\xeat temporaire)",id:"d\xe9sactiv\xe9-arr\xeat-temporaire",level:3},{value:"\ud83d\udd27 Configuration par environnement",id:"-configuration-par-environnement",level:2},{value:"Utiliser des variables d&#39;environnement",id:"utiliser-des-variables-denvironnement",level:3},{value:"Fichier de configuration d\xe9di\xe9",id:"fichier-de-configuration-d\xe9di\xe9",level:3},{value:"\ud83d\udd10 Configuration de s\xe9curit\xe9",id:"-configuration-de-s\xe9curit\xe9",level:2},{value:"Variables d&#39;environnement",id:"variables-denvironnement",level:3},{value:"Sur Vercel",id:"sur-vercel",level:3},{value:"D\xe9sactiver l&#39;authentification",id:"d\xe9sactiver-lauthentification",level:3},{value:"\ud83c\udfa8 Personnalisation de l&#39;indicateur visuel",id:"-personnalisation-de-lindicateur-visuel",level:2},{value:"Position personnalis\xe9e",id:"position-personnalis\xe9e",level:3},{value:"\ud83d\udcca Logs personnalis\xe9s",id:"-logs-personnalis\xe9s",level:2},{value:"Callback onUpdate",id:"callback-onupdate",level:3},{value:"\ud83d\ude80 Optimisations",id:"-optimisations",level:2},{value:"R\xe9duire la charge en production",id:"r\xe9duire-la-charge-en-production",level:3},{value:"D\xe9sactiver pendant les tests",id:"d\xe9sactiver-pendant-les-tests",level:3},{value:"\ud83d\udcdd R\xe9sum\xe9 des valeurs recommand\xe9es",id:"-r\xe9sum\xe9-des-valeurs-recommand\xe9es",level:2},{value:"\ud83d\udd17 Voir aussi",id:"-voir-aussi",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\ufe0f-configuration-avanc\xe9e",children:"\u2699\ufe0f Configuration avanc\xe9e"})}),"\n",(0,i.jsx)(n.p,{children:"Guide complet pour personnaliser le syst\xe8me de mise \xe0 jour automatique."}),"\n",(0,i.jsx)(n.h2,{id:"-options-du-composant",children:"\ud83d\udccb Options du composant"}),"\n",(0,i.jsxs)(n.h3,{id:"interface-monstersautoupdaterprops",children:["Interface ",(0,i.jsx)(n.code,{children:"MonstersAutoUpdaterProps"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"interface MonstersAutoUpdaterProps {\r\n  /** Intervalle minimum en millisecondes (par d\xe9faut 60000 = 1 minute) */\r\n  minInterval?: number\r\n  \r\n  /** Intervalle maximum en millisecondes (par d\xe9faut 180000 = 3 minutes) */\r\n  maxInterval?: number\r\n  \r\n  /** Active ou d\xe9sactive les mises \xe0 jour automatiques (par d\xe9faut true) */\r\n  enabled?: boolean\r\n  \r\n  /** Active les logs d\xe9taill\xe9s dans la console (par d\xe9faut true) */\r\n  verbose?: boolean\r\n  \r\n  /** Affiche un indicateur visuel des mises \xe0 jour (par d\xe9faut false) */\r\n  showIndicator?: boolean\r\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-configurations-courantes",children:"\ud83c\udf9b\ufe0f Configurations courantes"}),"\n",(0,i.jsx)(n.h3,{id:"configuration-par-d\xe9faut-1-3-minutes",children:"Configuration par d\xe9faut (1-3 minutes)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",metastring:'title="src/app/layout.tsx"',children:"<MonstersAutoUpdater\r\n  minInterval={60000}\r\n  maxInterval={180000}\r\n  enabled\r\n  verbose\r\n  showIndicator={false}\r\n/>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"configuration-rapide-30s---1min",children:"Configuration rapide (30s - 1min)"}),"\n",(0,i.jsx)(n.p,{children:"Pour un d\xe9veloppement plus rapide :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  minInterval={30000}   // 30 secondes\r\n  maxInterval={60000}   // 1 minute\r\n  enabled\r\n  verbose\r\n  showIndicator={true}  // Afficher l'indicateur\r\n/>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"configuration-lente-5-10-minutes",children:"Configuration lente (5-10 minutes)"}),"\n",(0,i.jsx)(n.p,{children:"Pour \xe9conomiser les ressources :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  minInterval={300000}  // 5 minutes\r\n  maxInterval={600000}  // 10 minutes\r\n  enabled\r\n  verbose\r\n  showIndicator={false}\r\n/>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"intervalle-fixe-toujours-2-minutes",children:"Intervalle fixe (toujours 2 minutes)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  minInterval={120000}\r\n  maxInterval={120000}  // M\xeame valeur = fixe\r\n  enabled\r\n  verbose\r\n  showIndicator={false}\r\n/>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"mode-d\xe9veloppement-debug-complet",children:"Mode d\xe9veloppement (debug complet)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  minInterval={10000}   // 10 secondes\r\n  maxInterval={30000}   // 30 secondes\r\n  enabled\r\n  verbose={true}        // Logs d\xe9taill\xe9s\r\n  showIndicator={true}  // Indicateur visible\r\n/>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"d\xe9sactiv\xe9-arr\xeat-temporaire",children:"D\xe9sactiv\xe9 (arr\xeat temporaire)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  minInterval={60000}\r\n  maxInterval={180000}\r\n  enabled={false}  // \u2190 D\xe9sactiv\xe9\r\n  verbose\r\n  showIndicator={false}\r\n/>\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-configuration-par-environnement",children:"\ud83d\udd27 Configuration par environnement"}),"\n",(0,i.jsx)(n.h3,{id:"utiliser-des-variables-denvironnement",children:"Utiliser des variables d'environnement"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",metastring:'title="src/app/layout.tsx"',children:"<MonstersAutoUpdater\r\n  minInterval={\r\n    process.env.NODE_ENV === 'production' \r\n      ? 60000   // 1 min en production\r\n      : 10000   // 10s en d\xe9veloppement\r\n  }\r\n  maxInterval={\r\n    process.env.NODE_ENV === 'production'\r\n      ? 180000  // 3 min en production\r\n      : 30000   // 30s en d\xe9veloppement\r\n  }\r\n  enabled\r\n  verbose={process.env.NODE_ENV !== 'production'}\r\n  showIndicator={process.env.NODE_ENV !== 'production'}\r\n/>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"fichier-de-configuration-d\xe9di\xe9",children:"Fichier de configuration d\xe9di\xe9"}),"\n",(0,i.jsxs)(n.p,{children:["Cr\xe9ez un fichier ",(0,i.jsx)(n.code,{children:"src/config/cron.config.ts"})," :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",metastring:'title="src/config/cron.config.ts"',children:"export const cronConfig = {\r\n  development: {\r\n    minInterval: 10000,  // 10 secondes\r\n    maxInterval: 30000,  // 30 secondes\r\n    enabled: true,\r\n    verbose: true,\r\n    showIndicator: true\r\n  },\r\n  production: {\r\n    minInterval: 60000,   // 1 minute\r\n    maxInterval: 180000,  // 3 minutes\r\n    enabled: true,\r\n    verbose: false,\r\n    showIndicator: false\r\n  }\r\n}\r\n\r\nexport const getCurrentConfig = () => {\r\n  return process.env.NODE_ENV === 'production'\r\n    ? cronConfig.production\r\n    : cronConfig.development\r\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Puis dans le layout :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",metastring:'title="src/app/layout.tsx"',children:"import { getCurrentConfig } from '@/config/cron.config'\r\n\r\n// ...\r\n\r\nconst cronSettings = getCurrentConfig()\r\n\r\n<MonstersAutoUpdater {...cronSettings} />\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-configuration-de-s\xe9curit\xe9",children:"\ud83d\udd10 Configuration de s\xe9curit\xe9"}),"\n",(0,i.jsx)(n.h3,{id:"variables-denvironnement",children:"Variables d'environnement"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-env",metastring:'title=".env.local"',children:"# Token secret pour l'API (serveur uniquement)\r\nCRON_SECRET_TOKEN=super_secret_token_123\r\n\r\n# Token public (client - doit \xeatre identique)\r\nNEXT_PUBLIC_CRON_SECRET_TOKEN=super_secret_token_123\n"})}),"\n",(0,i.jsx)(n.h3,{id:"sur-vercel",children:"Sur Vercel"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Allez dans ",(0,i.jsx)(n.strong,{children:"Settings"})," > ",(0,i.jsx)(n.strong,{children:"Environment Variables"})]}),"\n",(0,i.jsxs)(n.li,{children:["Ajoutez les deux variables :","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"CRON_SECRET_TOKEN"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"NEXT_PUBLIC_CRON_SECRET_TOKEN"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Red\xe9ployez"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"d\xe9sactiver-lauthentification",children:"D\xe9sactiver l'authentification"}),"\n",(0,i.jsxs)(n.p,{children:["Supprimez ou ne d\xe9finissez pas les variables ",(0,i.jsx)(n.code,{children:"CRON_SECRET_TOKEN"}),". L'endpoint sera accessible sans authentification."]}),"\n",(0,i.jsx)(n.h2,{id:"-personnalisation-de-lindicateur-visuel",children:"\ud83c\udfa8 Personnalisation de l'indicateur visuel"}),"\n",(0,i.jsx)(n.p,{children:"L'indicateur affiche :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\xc9tat actuel (en cours / inactif)"}),"\n",(0,i.jsx)(n.li,{children:"Nombre de mises \xe0 jour effectu\xe9es"}),"\n",(0,i.jsx)(n.li,{children:"Derni\xe8re mise \xe0 jour (succ\xe8s/erreur)"}),"\n",(0,i.jsx)(n.li,{children:"Temps avant la prochaine mise \xe0 jour"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"position-personnalis\xe9e",children:"Position personnalis\xe9e"}),"\n",(0,i.jsx)(n.p,{children:"Pour modifier la position, cr\xe9ez votre propre composant :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",metastring:'title="src/components/custom-updater.tsx"',children:"'use client'\r\n\r\nimport { useAutoUpdateMonsters } from '@/hooks/use-auto-update-monsters'\r\n\r\nexport function CustomUpdater() {\r\n  const { isUpdating, lastUpdate, updateCount, nextUpdateIn } = \r\n    useAutoUpdateMonsters({\r\n      minInterval: 60000,\r\n      maxInterval: 180000,\r\n      enabled: true,\r\n      verbose: true\r\n    })\r\n\r\n  return (\r\n    <div className=\"fixed top-4 right-4 bg-blue-500 text-white p-2 rounded\">\r\n      {isUpdating ? (\r\n        <p>\ud83d\udd04 Mise \xe0 jour en cours...</p>\r\n      ) : (\r\n        <div>\r\n          <p>\u2705 {updateCount} mises \xe0 jour</p>\r\n          {nextUpdateIn && (\r\n            <p className=\"text-xs\">\r\n              Prochaine : {Math.round(nextUpdateIn / 1000)}s\r\n            </p>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-logs-personnalis\xe9s",children:"\ud83d\udcca Logs personnalis\xe9s"}),"\n",(0,i.jsx)(n.h3,{id:"callback-onupdate",children:"Callback onUpdate"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"const [stats, setStats] = useState({ success: 0, errors: 0 })\r\n\r\n<MonstersAutoUpdater\r\n  minInterval={60000}\r\n  maxInterval={180000}\r\n  enabled\r\n  verbose\r\n  showIndicator={false}\r\n  onUpdate={(result) => {\r\n    if (result.success) {\r\n      setStats(prev => ({ ...prev, success: prev.success + 1 }))\r\n      // Envoi \xe0 un service analytics\r\n      analytics.track('Monster Update Success', {\r\n        updated: result.updated,\r\n        duration: result.duration\r\n      })\r\n    } else {\r\n      setStats(prev => ({ ...prev, errors: prev.errors + 1 }))\r\n      // Log d'erreur\r\n      console.error('Update failed:', result.error)\r\n    }\r\n  }}\r\n/>\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-optimisations",children:"\ud83d\ude80 Optimisations"}),"\n",(0,i.jsx)(n.h3,{id:"r\xe9duire-la-charge-en-production",children:"R\xe9duire la charge en production"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"const isProduction = process.env.NODE_ENV === 'production'\r\n\r\n<MonstersAutoUpdater\r\n  minInterval={isProduction ? 300000 : 30000}  // 5 min vs 30s\r\n  maxInterval={isProduction ? 600000 : 60000}  // 10 min vs 1 min\r\n  enabled\r\n  verbose={!isProduction}  // Logs seulement en dev\r\n  showIndicator={!isProduction}\r\n/>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"d\xe9sactiver-pendant-les-tests",children:"D\xe9sactiver pendant les tests"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"const isTesting = process.env.NODE_ENV === 'test'\r\n\r\n<MonstersAutoUpdater\r\n  minInterval={60000}\r\n  maxInterval={180000}\r\n  enabled={!isTesting}  // D\xe9sactiv\xe9 en test\r\n  verbose\r\n  showIndicator={false}\r\n/>\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-r\xe9sum\xe9-des-valeurs-recommand\xe9es",children:"\ud83d\udcdd R\xe9sum\xe9 des valeurs recommand\xe9es"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Environnement"}),(0,i.jsx)(n.th,{children:"minInterval"}),(0,i.jsx)(n.th,{children:"maxInterval"}),(0,i.jsx)(n.th,{children:"verbose"}),(0,i.jsx)(n.th,{children:"showIndicator"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"D\xe9veloppement"})}),(0,i.jsx)(n.td,{children:"10000 (10s)"}),(0,i.jsx)(n.td,{children:"30000 (30s)"}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsx)(n.td,{children:"true"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Staging"})}),(0,i.jsx)(n.td,{children:"30000 (30s)"}),(0,i.jsx)(n.td,{children:"120000 (2min)"}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsx)(n.td,{children:"false"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Production"})}),(0,i.jsx)(n.td,{children:"60000 (1min)"}),(0,i.jsx)(n.td,{children:"180000 (3min)"}),(0,i.jsx)(n.td,{children:"false"}),(0,i.jsx)(n.td,{children:"false"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Test"})}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsx)(n.td,{children:"false"}),(0,i.jsx)(n.td,{children:"false (d\xe9sactiv\xe9)"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"-voir-aussi",children:"\ud83d\udd17 Voir aussi"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/documentation/cron/api-reference",children:"API Reference"})," - Documentation de l'API"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/documentation/cron/api-reference#hook-useautoupdatemonsters",children:"Hook useAutoUpdateMonsters"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/documentation/cron/troubleshooting",children:"D\xe9pannage"})," - R\xe9soudre les probl\xe8mes"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);